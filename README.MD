# StackSpot API Integration ‚Äî Cliente Java

Um cliente Java enxuto para integra√ß√£o com a API StackSpot AI. Este projeto oferece uma camada de abstra√ß√£o para autentica√ß√£o baseada em token, conversas com o agente de IA (chat) e gerenciamento de execu√ß√µes.

## Vis√£o geral

- Linguagem: Java 17+
- Build: Maven
- Framework web: Spring Boot (controllers REST)

O objetivo √© fornecer um exemplo reutiliz√°vel de como autenticar e consumir os endpoints da StackSpot AI em aplica√ß√µes Java, com foco em:
- Gerenciamento seguro de tokens (renova√ß√£o autom√°tica)
- Intera√ß√µes com agente de chat (request/response)
- Cria√ß√£o e acompanhamento de execu√ß√µes

## Pr√©-requisitos

- JDK 17 ou superior
- Maven 3.6+
- Credenciais da StackSpot (Realm, Client ID, Client Secret, Agent ID e Quick command name)


## üöÄ Features

- Token-based authentication with automatic renewal
- AI chat interactions with streaming response support
- Execution management for AI operations
- Conversation tracking and management
- Environment configuration management

## üìã Prerequisites

- Java 17 or higher
- Maven
- StackSpot API credentials (Realm, Client ID, and Client Secret)

## ‚öôÔ∏è Configuration

1. Create a `.env` file in the project root based on the provided `.env.example`:

## Vari√°veis de ambiente / Configura√ß√£o

Crie um arquivo `.env` na raiz do projeto (ou configure vari√°veis de ambiente no seu ambiente de execu√ß√£o) com os seguintes valores:

```

STACKSPOT_REALM=seu_realm
STACKSPOT_CLIENT_ID=seu_client_id
STACKSPOT_CLIENT_SECRET=seu_client_secret
QUICK_COMMAND_NAME=seu_quick_command_name
AGENT_ID=seu_agent_id

```

Observa√ß√£o: o projeto j√° faz refer√™ncia ao uso de uma biblioteca para carregar vari√°veis de ambiente. Garanta que as credenciais n√£o sejam comitadas no reposit√≥rio.

## Conte√∫do do reposit√≥rio

Principais pacotes:

- `org.stackspotapi.controller` ‚Äî endpoints REST expostos pela aplica√ß√£o (ex.: `ChatController`).
- `org.stackspotapi.service` ‚Äî servi√ßos que encapsulam l√≥gica de autentica√ß√£o, chat e execu√ß√£o.
- `org.stackspotapi.dto` ‚Äî objetos de transfer√™ncia de dados (requests/responses).

Estrutura (resumida):
```
src/main/java/org/stackspotapi/
‚îú‚îÄ‚îÄ StackSpotApiApplication.java    # Ponto de entrada da aplica√ß√£o
‚îú‚îÄ‚îÄ controller/
‚îÇ   ‚îî‚îÄ‚îÄ ChatController.java        # Endpoint: /api/v1/chat
‚îú‚îÄ‚îÄ service/
‚îÇ   ‚îú‚îÄ‚îÄ AiChatService.java
‚îÇ   ‚îú‚îÄ‚îÄ EnsureTokenService.java
‚îÇ   ‚îî‚îÄ‚îÄ ExecutionService.java
‚îî‚îÄ‚îÄ dto/                           # DTOs usados nas requests e responses
```

## Como compilar e executar

1. Compilar:

```bash
mvn clean package
```

2. Executar (modo local):

```bash
java -jar target/*.jar
```

A aplica√ß√£o inicia um servidor web (Spring Boot). Por padr√£o, o arquivo `ChatController` exp√µe um endpoint HTTP:

- POST /api/v1/chat

## Endpoints (resumo)

### POST /api/v1/chat
Envia um prompt para o servi√ßo de chat e retorna a resposta gerada pela IA.

Request (JSON):

```json
{
  "prompt": "Pergunte algo ao agente",
  "conversationId": "opcional-id-da-conversa"
}
```

Response:
- 200 OK ‚Äî corpo com a resposta gerada pelo agente (texto)
- 400 Bad Request ‚Äî prompt ausente ou inv√°lido
- 500 Internal Server Error ‚Äî falha de comunica√ß√£o ou erro interno

Exemplo CURL:

```bash
curl -X POST http://localhost:8080/api/v1/chat \
  -H "Content-Type: application/json" \
  -d '{"prompt":"Qual √© a capital da Fran√ßa?"}'
```

## Observa√ß√µes de implementa√ß√£o

- `ChatController` valida se o prompt est√° presente e delega a chamada ao `AiChatService`.
- `AiChatService` √© respons√°vel por obter/renovar tokens (via `EnsureTokenService`) e enviar requisi√ß√µes para a API StackSpot.
- `ExecutionService` gerencia execu√ß√µes e conversas (cria√ß√£o/consulta de execu√ß√µes e identifica√ß√£o de conversationId).

## Como contribuir

1. Fa√ßa um fork do projeto
2. Crie uma branch com uma descri√ß√£o curta (`feature/`, `fix/`)
3. Fa√ßa altera√ß√µes e escreva testes quando aplic√°vel
4. Abra um Pull Request descrevendo a mudan√ßa

## Seguran√ßa e boas pr√°ticas

- Nunca comite credenciais. Use `.gitignore` para `.env`.
- Habilite logs para depura√ß√£o, mas evite imprimir segredos.
- Considere adicionar limites de taxa e tratamento de timeouts ao cliente HTTP.

## Pr√≥ximos passos sugeridos (opcionais)

- Adicionar exemplos de uso do `AiChatService` em um pequeno cliente CLI ou testes de integra√ß√£o.
- Incluir GitHub Actions para build/test/scan de seguran√ßa.
- Documentar contrato JSON com OpenAPI/Swagger.

## Contato

Abra uma issue no reposit√≥rio para d√∫vidas, bugs ou sugest√µes.
